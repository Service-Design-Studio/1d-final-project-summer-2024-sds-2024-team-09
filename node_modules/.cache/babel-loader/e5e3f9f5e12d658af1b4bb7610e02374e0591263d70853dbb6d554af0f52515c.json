{"ast":null,"code":"import { connectStreamSource, disconnectStreamSource } from \"@hotwired/turbo\";\nimport { subscribeTo } from \"./cable\";\nimport snakeize from \"./snakeize\";\nclass TurboCableStreamSourceElement extends HTMLElement {\n  async connectedCallback() {\n    connectStreamSource(this);\n    this.subscription = await subscribeTo(this.channel, {\n      received: this.dispatchMessageEvent.bind(this),\n      connected: this.subscriptionConnected.bind(this),\n      disconnected: this.subscriptionDisconnected.bind(this)\n    });\n  }\n  disconnectedCallback() {\n    disconnectStreamSource(this);\n    if (this.subscription) this.subscription.unsubscribe();\n  }\n  dispatchMessageEvent(data) {\n    const event = new MessageEvent(\"message\", {\n      data\n    });\n    return this.dispatchEvent(event);\n  }\n  subscriptionConnected() {\n    this.setAttribute(\"connected\", \"\");\n  }\n  subscriptionDisconnected() {\n    this.removeAttribute(\"connected\");\n  }\n  get channel() {\n    const channel = this.getAttribute(\"channel\");\n    const signed_stream_name = this.getAttribute(\"signed-stream-name\");\n    return {\n      channel,\n      signed_stream_name,\n      ...snakeize({\n        ...this.dataset\n      })\n    };\n  }\n}\nif (customElements.get(\"turbo-cable-stream-source\") === undefined) {\n  customElements.define(\"turbo-cable-stream-source\", TurboCableStreamSourceElement);\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}